(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4b1ef75b"],{1316:function(e,t,a){e.exports=a("9cd3")},"13d5":function(e,t,a){"use strict";var n=a("23e7"),r=a("d58f").left;n({target:"Array",proto:!0,forced:a("b301")("reduce")},{reduce:function(e,t){return r(this,e,arguments.length,1<arguments.length?t:void 0)}})},"2dc0":function(e,t,a){e.exports=a("588c")},"471b":function(e,t,a){"use strict";var n=a("194a"),r=a("4fff"),i=a("faaa"),c=a("2616"),o=a("6725"),l=a("6c15"),s=a("0b7b");e.exports=function(e,t,a){var u,d,f,p,b,h=r(e),m="function"==typeof this?this:Array,v=arguments.length,y=1<v?t:void 0,k=void 0!==y,g=0,x=s(h);if(k&&(y=n(y,2<v?a:void 0,2)),null==x||m==Array&&c(x))for(d=new m(u=o(h.length));g<u;g++)l(d,g,k?y(h[g],g):h[g]);else for(b=(p=x.call(h)).next,d=new m;!(f=b.call(p)).done;g++)l(d,g,k?i(p,y,[f.value,g],!0):f.value);return d.length=g,d}},"484e":function(e,t,a){var n=a("a5eb"),r=a("471b");n({target:"Array",stat:!0,forced:!a("7de7")((function(e){Array.from(e)}))},{from:r})},"4ec9":function(e,t,a){"use strict";var n=a("6d61"),r=a("6566");e.exports=n("Map",(function(e){return function(t){return e(this,arguments.length?t:void 0)}}),r,!0)},"4f97":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));var n={type:[{label:"现金卡",value:1},{label:"充值卡",value:2},{label:"兑换卡",value:3}],constType:[{label:"现金卡",value:"CASH"},{label:"充值卡",value:"CHARGE"},{label:"兑换卡",value:"EXCHANGE"}],status:[{label:"未激活",value:0},{label:"已激活",value:1},{label:"已使用",value:2},{label:"已过期",value:99}],useStatus:[{label:"未兑换",value:0},{label:"已兑换",value:1}]},r={status:[{label:"待付款",value:0},{label:"待发货",value:1},{label:"待收货",value:2},{label:"已完成",value:3},{label:"已关闭",value:4}],express:[{label:"已揽收",value:1},{label:"在途中",value:2},{label:"到达派件城市",value:201},{label:"签收",value:3}],abnormalStatus:[{label:"无轨迹",value:0},{label:"问题件",value:4}]}},"588c":function(e,t,a){a("5145"),a("3e47"),e.exports=a("59d7")},"59d7":function(e,t,a){var n=a("8f95"),r=a("0363"),i=a("7463"),c=r("iterator");e.exports=function(e){var t=Object(e);return void 0!==t[c]||"@@iterator"in t||i.hasOwnProperty(n(t))}},"5a65":function(e,t,a){"use strict";var n=a("9f12"),r=a("53fe"),i=a("8b83"),c=a("c65a"),o=a("c03e"),l=a("9ab4"),s=a("60a3"),u=a("4f97"),d=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(i.a)(this,Object(c.a)(t).apply(this,arguments))).form={name:"",cardType:"",status:""},e.dictTicket=u.b,e}return Object(o.a)(t,e),Object(r.a)(t,[{key:"handleSearch",value:function(){return this.$emit("search"),Object.assign({},this.value,this.form,{pageNum:1})}}]),t}(s.h);l.a([Object(s.d)("input",{type:Object,default:function(){return{}}})],d.prototype,"value",void 0),l.a([Object(s.b)("input")],d.prototype,"handleSearch",null);var f=d=l.a([Object(s.a)({name:"FormSearch"})],d),p=a("2877"),b=Object(p.a)(f,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{inline:!0,model:e.form,size:"small"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{clearable:""},model:{value:e.form.cardType,callback:function(t){e.$set(e.form,"cardType",t)},expression:"form.cardType"}},e._l(e.dictTicket.type,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")])],1)],1)}),[],!1,null,null,null);t.a=b.exports},"5ab9":function(e,t,a){a("e519");var n=a("764b");e.exports=n.Array.isArray},6566:function(e,t,a){"use strict";var n=a("9bf2").f,r=a("7c73"),i=a("e2cc"),c=a("f8c2"),o=a("19aa"),l=a("2266"),s=a("7dd0"),u=a("2626"),d=a("83ab"),f=a("f183").fastKey,p=a("69f3"),b=p.set,h=p.getterFor;e.exports={getConstructor:function(e,t,a,s){function u(e,t,a){var n,r,i=m(e),c=v(e,t);return c?c.value=a:(i.last=c={index:r=f(t,!0),key:t,value:a,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=c),n&&(n.next=c),d?i.size++:e.size++,"F"!==r&&(i.index[r]=c)),e}var p=e((function(e,n){o(e,p,t),b(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),d||(e.size=0),null!=n&&l(n,e[s],e,a)})),m=h(t),v=function(e,t){var a,n=m(e),r=f(t);if("F"!==r)return n.index[r];for(a=n.first;a;a=a.next)if(a.key==t)return a};return i(p.prototype,{clear:function(){for(var e=m(this),t=e.index,a=e.first;a;)a.removed=!0,a.previous&&(a.previous=a.previous.next=void 0),delete t[a.index],a=a.next;e.first=e.last=void 0,d?e.size=0:this.size=0},delete:function(e){var t=m(this),a=v(this,e);if(a){var n=a.next,r=a.previous;delete t.index[a.index],a.removed=!0,r&&(r.next=n),n&&(n.previous=r),t.first==a&&(t.first=n),t.last==a&&(t.last=r),d?t.size--:this.size--}return!!a},forEach:function(e,t){for(var a,n=m(this),r=c(e,1<arguments.length?t:void 0,3);a=a?a.next:n.first;)for(r(a.value,a.key,this);a&&a.removed;)a=a.previous},has:function(e){return!!v(this,e)}}),i(p.prototype,a?{get:function(e){var t=v(this,e);return t&&t.value},set:function(e,t){return u(this,0===e?0:e,t)}}:{add:function(e){return u(this,e=0===e?0:e,e)}}),d&&n(p.prototype,"size",{get:function(){return m(this).size}}),p},setStrong:function(e,t,a){var n=t+" Iterator",r=h(t),i=h(n);s(e,t,(function(e,t){b(this,{type:n,target:e,state:r(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,a=e.last;a&&a.removed;)a=a.previous;return e.target&&(e.last=a=a?a.next:e.state.first)?"keys"==t?{value:a.key,done:!1}:"values"==t?{value:a.value,done:!1}:{value:[a.key,a.value],done:!1}:{value:e.target=void 0,done:!0}}),a?"entries":"values",!a,!0),u(t)}}},"6d61":function(e,t,a){"use strict";var n=a("23e7"),r=a("da84"),i=a("94ca"),c=a("6eeb"),o=a("f183"),l=a("2266"),s=a("19aa"),u=a("861d"),d=a("d039"),f=a("1c7e"),p=a("d44e"),b=a("7156");e.exports=function(e,t,a,h,m){function v(e){var t=k[e];c(k,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(m&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return m&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(m&&!u(e))&&t.call(this,0===e?0:e)}:function(e,a){return t.call(this,0===e?0:e,a),this})}var y=r[e],k=y&&y.prototype,g=y,x=h?"set":"add",j={};if(i(e,"function"!=typeof y||!(m||k.forEach&&!d((function(){(new y).entries().next()})))))g=a.getConstructor(t,e,h,x),o.REQUIRED=!0;else if(i(e,!0)){var w=new g,O=w[x](m?{}:-0,1)!=w,_=d((function(){w.has(1)})),T=f((function(e){new y(e)})),E=!m&&d((function(){for(var e=new y,t=5;t--;)e[x](t,t);return!e.has(-0)}));T||(((g=t((function(t,a){s(t,g,e);var n=b(new y,t,g);return null!=a&&l(a,n[x],n,h),n}))).prototype=k).constructor=g),(_||E)&&(v("delete"),v("has"),h&&v("get")),(E||O)&&v(x),m&&k.clear&&delete k.clear}return j[e]=g,n({global:!0,forced:g!=y},j),p(g,e),m||a.setStrong(g,e,h),g}},"73a1":function(e,t,a){},"74e7":function(e,t,a){e.exports=a("bc59")},"8b2d":function(e,t,a){"use strict";var n=a("73a1");a.n(n).a},"90db":function(e,t,a){"use strict";a.r(t),a("a4d3"),a("99af"),a("4de4"),a("4160"),a("caad"),a("d81d"),a("b0c0"),a("e439"),a("dbb4"),a("b64b"),a("159b");var n=a("2fa7"),r=(a("96cf"),a("89ba")),i=a("9f12"),c=a("53fe"),o=a("8b83"),l=a("c65a"),s=a("c03e"),u=a("9ab4"),d=a("60a3"),f=a("5a65"),p=a("ae85"),b=a("4f97"),h=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(o.a)(this,Object(l.a)(t).apply(this,arguments))).dictTicket=b.b,e}return Object(s.a)(t,e),t}(Object(d.c)(p.a)),m=h=u.a([Object(d.a)({components:{FormSearch:f.a},mixins:[p.a],name:"TableList"})],h),v=a("2877"),y=Object(v.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("slw-table",e._g(e._b({attrs:{"show-selection":e.selection}},"slw-table",e.$attrs,!1),e.$listeners),[a("template",{slot:"query"},[e._t("default")],2),a("template",{slot:"button"},[e.onlyView?e._e():a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$emit("add")}}},[e._v("添加卡券")])],1),a("el-table-column",{attrs:{prop:"name",label:"图片"},scopedSlots:e._u([{key:"default",fn:function(e){return a("el-image",{staticClass:"global__img--thumb",attrs:{fit:"contain",src:e.row.coverImage}},[a("i",{staticClass:"el-icon-picture-outline",attrs:{slot:"error"},slot:"error"})])}}])}),a("el-table-column",{attrs:{label:"名称",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return e.onlyView?a("span",[e._v(e._s(t.row.name))]):a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.$emit("view",t.row)}}},[e._v(e._s(t.row.name))])}}],null,!0)}),a("el-table-column",{attrs:{label:"类型 "},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[e._v(" "+e._s(e._f("filterDict")(t.row.cardType,e.dictTicket.constType))+" ")])}}])}),a("el-table-column",{attrs:{label:"金额（元）"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[e._v(e._s(e._f("formatMoney")(t.row.amount)))])}}])}),a("el-table-column",{attrs:{label:"添加时间",prop:"beginDate",width:"150px"}}),a("el-table-column",{attrs:{label:"有效期",prop:"endDate",width:"150px"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[e._v(" "+e._s(e._f("filterDict")(t.row.status,e.dictTicket.status))+" ")])}}])}),e.onlyView?e._e():a("el-table-column",{attrs:{label:"操作",width:"230px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"dark",content:"生成卡券"}},[a("el-button",{attrs:{icon:"el-icon-plus",size:"mini",plain:"",type:"primary"},on:{click:function(a){return e.$emit("generate",t.row)}}})],1),a("el-tooltip",{attrs:{effect:"dark",content:"查看卡券"}},[a("el-button",{attrs:{plain:"",type:"warning",icon:"el-icon-view",size:"mini"},on:{click:function(a){return e.$emit("view-ticket",t.row)}}})],1),a("el-tooltip",{attrs:{effect:"dark",content:"编辑"}},[a("el-button",{attrs:{plain:"",type:"success",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.$emit("edit",t.row)}}})],1),a("el-tooltip",{attrs:{effect:"dark",content:"删除"}},[a("el-button",{attrs:{plain:"",type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.handleDel(t.row)}}})],1)]}}],null,!1,3654025395)})],2)}),[],!1,null,null,null).exports,k=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(o.a)(this,Object(l.a)(t).apply(this,arguments))).dictTicket=b.b,e}return Object(s.a)(t,e),Object(c.a)(t,[{key:"clearSelection",value:function(){this.table.clearSelection()}}]),t}(Object(d.c)(p.a));u.a([Object(d.g)()],k.prototype,"table",void 0);var g=k=u.a([Object(d.a)({components:{FormSearch:f.a},mixins:[p.a],name:"TableList"})],k),x=Object(v.a)(g,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("slw-table",e._g(e._b({ref:"table"},"slw-table",e.$attrs,!1),e.$listeners),[a("template",{slot:"button"},[e._t("button")],2),a("template",{slot:"query"},[e._t("default")],2),a("el-table-column",{attrs:{label:"卡号",prop:"no"}}),a("el-table-column",{attrs:{label:"密码",prop:"password"}}),a("el-table-column",{attrs:{label:"兑换次数(已用/总数)"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[e._v(" "+e._s(t.row.usedTimes)+" / "+e._s(t.row.totalTimes)+" ")])}}])}),a("el-table-column",{attrs:{label:"有效期",width:"250px"},scopedSlots:e._u([{key:"default",fn:function(t){return a("el-date-picker",{attrs:{type:"date",clearable:!1,"value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:function(a){return e.$emit("endDate-change",t.row)}},model:{value:t.row.endDate,callback:function(a){e.$set(t.row,"endDate",a)},expression:"scope.row.endDate"}})}}])}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[e._v(" "+e._s(e._f("filterDict")(t.row.status,e.dictTicket.status))+" ")])}}])}),a("el-table-column",{attrs:{label:"设置状态"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("el-switch",{attrs:{disabled:1<t.row.status,"active-value":1,"inactive-value":0},on:{change:function(a){return e.$emit("status-change",t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})],1)}}])})],2)}),[],!1,null,null,null).exports,j=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(o.a)(this,Object(l.a)(t).apply(this,arguments))).form={status:"",no:""},e.dictTicket=b.b,e}return Object(s.a)(t,e),Object(c.a)(t,[{key:"handleSearch",value:function(){return this.$emit("search"),Object.assign({},this.value,this.form,{pageNum:1})}}]),t}(d.h);u.a([Object(d.d)("input",{type:Object,default:function(){return{}}})],j.prototype,"value",void 0),u.a([Object(d.b)("input")],j.prototype,"handleSearch",null);var w=j=u.a([Object(d.a)({name:"FormSearch"})],j),O=Object(v.a)(w,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{inline:!0,model:e.form,size:"small"}},[a("el-form-item",{attrs:{label:"卡号"}},[a("el-input",{attrs:{clearable:""},model:{value:e.form.no,callback:function(t){e.$set(e.form,"no",t)},expression:"form.no"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{clearable:""},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.dictTicket.status,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")])],1)],1)}),[],!1,null,null,null).exports,_=(a("c975"),function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(o.a)(this,Object(l.a)(t).apply(this,arguments))).form={quantity:1,cardSubjectId:"",active:!1,exchangeArr:[{quantity:1,number:1}]},e.rule={quantity:[{required:!0,message:"请选择生成的数量",trigger:"blur"}]},e}return Object(s.a)(t,e),Object(c.a)(t,[{key:"addCardElement",value:function(){this.form.exchangeArr.push({quantity:1,number:1})}},{key:"delCardElement",value:function(){this.form.exchangeArr.pop()}},{key:"watchData",value:function(e){e&&(this.form.cardSubjectId=e.id)}},{key:"submit",value:function(){var e=this;this.$refs.form.validate((function(t){t&&("exchange"===e.type?delete e.form.quantity:delete e.form.exchangeArr,e.$emit("submit",e.form))}))}}]),t}(d.h));u.a([Object(d.e)({type:Object,default:function(){}})],_.prototype,"data",void 0),u.a([Object(d.e)({type:String,default:"exchange",validator:function(e){return-1!==["exchange","others"].indexOf(e)}})],_.prototype,"type",void 0),u.a([Object(d.i)("data",{deep:!0,immediate:!0})],_.prototype,"watchData",null);var T=_=u.a([Object(d.a)({name:"FormGenerate"})],_),E=(a("8b2d"),Object(v.a)(T,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"generate"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rule,"label-width":"85px"}},[a("el-form-item",{attrs:{label:"卡券名称"}},[a("strong",[e._v(e._s(e.data.name))])]),a("el-form-item",{attrs:{label:"立即激活",prop:"active"}},[a("el-switch",{model:{value:e.form.active,callback:function(t){e.$set(e.form,"active",t)},expression:"form.active"}}),"exchange"===e.type?a("div",{staticClass:"generate__add"},[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"primary",plain:""},on:{click:e.addCardElement}},[e._v("添加")]),a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",disabled:e.form.exchangeArr.length<=1},on:{click:e.delCardElement}},[e._v("删除")])],1):e._e()],1),"exchange"===e.type?e._l(e.form.exchangeArr,(function(t,n){return a("el-row",{key:n},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"生成数量",prop:"exchangeArr."+n+".quantity",rules:{required:!0,message:"数量不能为空",trigger:"blur"}}},[a("el-input",{attrs:{type:"number"},model:{value:t.quantity,callback:function(a){e.$set(t,"quantity",e._n(a))},expression:"item.quantity"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v("张")])])],1)],1),a("el-col",{attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"兑换次数",prop:"exchangeArr."+n+".number",rules:{required:!0,message:"兑换次数不能为空",trigger:"blur"}}},[a("el-input",{attrs:{type:"number"},model:{value:t.number,callback:function(a){e.$set(t,"number",e._n(a))},expression:"item.number"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v("张")])])],1)],1)],1)})):a("el-form-item",{attrs:{label:"生成数量",prop:"quantity"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.quantity,callback:function(t){e.$set(e.form,"quantity",t)},expression:"form.quantity"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v("张")])])],1),a("el-form-item",[a("el-button-group",[a("el-button",{attrs:{plain:"",type:"primary"},on:{click:e.submit}},[e._v("生成")]),a("el-button",{attrs:{plain:""},on:{click:function(t){return e.$emit("cancel",e.form)}}},[e._v("取消")])],1)],1)],2)],1)}),[],!1,null,"00b6a32e",null).exports),S=a("a78e"),D=a.n(S),$=a("9ff6"),A=a("cebe"),P=a.n(A),R=a("d257");function q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?q(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):q(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var L=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(o.a)(this,Object(l.a)(t).apply(this,arguments))).params={pageNum:1,pageSize:10},e.ticketParams={cardSubjectId:0,pageNum:1,pageSize:10,no:"",status:""},e.loading=!1,e.genLoading=!1,e.ticketLoading=!1,e.ticketSelection=[],e.data={},e.generateDesc="",e.ticketData={},e.cardType="",e.ticket={id:0,name:"",coverImage:"",amount:0,beginDate:"",endDate:"",status:0,remark:""},e.selectAll=!1,e.dialogGenerate=!1,e.dialogViewTicket=!1,e.generateTip="",e.firstNo="",e.lastNo="",e}var a,n,u,d,f,p,b,h;return Object(s.a)(t,e),Object(c.a)(t,[{key:"hanldeFetchData",value:(h=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.$ajax.ajax({method:"GET",url:"v1/cards/subjects",query:this.params});case 3:this.data=e.sent,this.loading=!1;case 5:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"hanldeFetchTicket",value:(b=Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ticketLoading=!0,e.next=3,this.$ajax.ajax({method:"GET",url:"v1/cards",query:I({},this.ticketParams,{cardSubjectId:this.ticket.id})});case 3:this.ticketData=e.sent,this.ticketLoading=!1;case 5:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"handleGoDetail",value:function(e){var t=e.id;this.$router.push({path:"/ticket/detail/".concat(t)})}},{key:"handleViewTicket",value:function(e){this.ticket=e,this.hanldeFetchTicket(),this.dialogViewTicket=!0}},{key:"handleEditTicket",value:function(e){var t=e.id;this.$router.push({path:"/ticket/edit/".concat(t)})}},{key:"handleTicketStatus",value:(p=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax.ajax({method:"PUT",url:"v1/cards/enable",query:{id:t.id,enable:t.status}});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"handleDialogGenerate",value:function(e){this.ticket=e,this.cardType=["EXCHANGE",3].includes(e.cardType)?"exchange":"others",this.dialogGenerate=!0}},{key:"handleGenerateTicket",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(t){var a,n,r,i,c,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.cardSubjectId,n=t.quantity,r=t.active,i=t.exchangeArr,this.genLoading=!0,e.next=4,this.$ajax.ajax({method:"POST",url:"exchange"===this.cardType?"v1/cards/exchanges":"v1/cards",query:{cardSubjectId:a,active:r,quantity:n},data:i});case 4:c=e.sent,o=c.firstNo,l=c.lastNo,this.genLoading=!1,o&&l?(this.generateTip="本次已生成".concat(n,"张卡券，卡号：").concat(o," ～ ").concat(l,"。"),this.firstNo=o,this.lastNo=l):this.$notify({type:"error",title:"提示",message:"生成失败"});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"handleSelectionAll",value:function(){this.selectAll=!this.selectAll}},{key:"handleSelection",value:function(e){this.ticketSelection=e}},{key:"handleSearchTicket",value:function(){this.ticketData={},this.selectAll=!1,this.$refs.ticketTable.clearSelection()}},{key:"handleDel",value:(d=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax.ajax({method:"DELETE",url:"v1/cards/subjects/".concat(t.id)});case 2:if(e.sent)return e.next=6,this.hanldeFetchData();e.next=8;break;case 6:e.next=9;break;case 8:this.$notify.error({title:"提示",message:"删除失败"});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"handleAddTicket",value:function(){this.$router.push({path:"/ticket/edit"})}},{key:"handleDelSelectionTicket",value:(u=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax.ajax({method:"DELETE",url:"v1/cards/card-subject-id",query:{cardSubjectId:this.ticket.id},data:t.map((function(e){return e.id}))});case 2:if(e.sent)return e.next=6,this.hanldeFetchTicket();e.next=8;break;case 6:e.next=9;break;case 8:this.$notify.error({title:"提示",message:"删除失败"});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"handleTicketEndDate",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax.ajax({method:"PUT",url:"v1/cards/end-date",query:{id:t.id,endDate:t.endDate}});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"selectable",value:function(e){return!e.status}},{key:"getRowKey",value:function(e){return e.id}},{key:"exportExcel",value:(a=Object(r.a)(regeneratorRuntime.mark((function e(t,a,n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ticketLoading=!0,e.next=3,P()({method:"post",url:t,params:a,data:n,baseURL:Object({NODE_ENV:"production",VUE_APP_COPYRIGHT:"Copyright © 2019 广东水联网农业科技有限公司保留所有权利。",VUE_APP_QRCODE_API:"https://cli.im/api/qrcode/code?text=",VUE_APP_TITLE:"水联网电商管理平台",VUE_APP_UPLOAD_ACTIONS:"v1/commons/attachments",BASE_URL:"/"}).API,responseType:"blob",headers:{"X-Requested-Id":Math.random(),Authorization:D.a.get($.c)}});case 3:i=e.sent,Object(R.a)([i.data],"".concat(r,".xlsx")),this.ticketLoading=!1;case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"exportExcelInterval",value:function(){var e=this.ticket,t=e.id,a=e.name;this.exportExcel("/api/v1/cards/excels/interval",{cardSubjectId:t,firstNo:this.firstNo,lastNo:this.lastNo},null,"".concat(t,"_").concat(a,"_").concat(this.firstNo,"-").concat(this.lastNo))}},{key:"exportExcelById",value:function(e){if(e||this.ticketSelection.length){var t=this.ticket,a=t.id,n=t.name;this.exportExcel(e?"/api/v1/cards/excels/".concat(a):"/api/v1/cards/excels/?cardSubjectId=".concat(a),null,e?null:this.ticketSelection.map((function(e){return e.id})),"".concat(a,"_").concat(n,"_").concat(e?"全部数据":"指定数据"))}else this.$notify.warning({title:"提示",message:"请选择卡券再进行导出excel"})}},{key:"isExcelAll",get:function(){return this.selectAll||this.ticketParams.no||this.ticketParams.status}}]),t}(d.h),N=L=u.a([Object(d.a)({name:"TicketIndex",components:{TableList:y,FormSearchTicket:O,TableTicketList:x,FormGenerate:E,FormSearch:f.a}})],L),z=Object(v.a)(N,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"ticket"},[a("table-list",{attrs:{"del-tip":"确定要删除该卡券主题吗？",data:e.data},on:{add:e.handleAddTicket,view:e.handleGoDetail,edit:e.handleEditTicket,fetch:e.hanldeFetchData,del:e.handleDel,generate:e.handleDialogGenerate,"view-ticket":e.handleViewTicket},model:{value:e.params,callback:function(t){e.params=t},expression:"params"}},[a("form-search",{on:{search:function(t){e.data={}}},model:{value:e.params,callback:function(t){e.params=t},expression:"params"}})],1),a("slw-dialog",{attrs:{title:"生成卡券",width:"40%"},on:{close:function(t){e.generateTip=""}},model:{value:e.dialogGenerate,callback:function(t){e.dialogGenerate=t},expression:"dialogGenerate"}},[a("el-alert",{directives:[{name:"show",rawName:"v-show",value:e.generateTip,expression:"generateTip"}],attrs:{closable:!1,title:e.generateTip,type:"success","show-icon":""}},[a("el-button",{attrs:{type:"text"},on:{click:e.exportExcelInterval}},[e._v("导出excel")])],1),a("br"),a("form-generate",{directives:[{name:"loading",rawName:"v-loading",value:e.genLoading,expression:"genLoading"}],attrs:{data:e.ticket,type:e.cardType},on:{submit:e.handleGenerateTicket,cancel:function(t){e.dialogGenerate=!1}}}),a("span",{attrs:{slot:"footer"},slot:"footer"})],1),a("slw-dialog",{attrs:{title:"查看卡券",width:"90%"},model:{value:e.dialogViewTicket,callback:function(t){e.dialogViewTicket=t},expression:"dialogViewTicket"}},[a("section",{directives:[{name:"loading",rawName:"v-loading",value:e.ticketLoading,expression:"ticketLoading"}]},[a("table-ticket-list",{ref:"ticketTable",attrs:{"del-tip":"确定要删除该卡券吗？",data:e.ticketData,"show-selection":"","del-section":"","reserve-selection":"","row-key":e.getRowKey},on:{"del-selection":e.handleDelSelectionTicket,fetch:e.hanldeFetchTicket,select:e.handleSelection,"status-change":e.handleTicketStatus,"endDate-change":e.handleTicketEndDate,"select-all":e.handleSelectionAll},model:{value:e.ticketParams,callback:function(t){e.ticketParams=t},expression:"ticketParams"}},[a("form-search-ticket",{on:{search:e.handleSearchTicket},model:{value:e.ticketParams,callback:function(t){e.ticketParams=t},expression:"ticketParams"}}),a("el-button",{attrs:{slot:"button",size:"small",type:e.isExcelAll?"primary":"default"},on:{click:function(t){return e.exportExcelById(e.isExcelAll)}},slot:"button"},[e._v(e._s(e.isExcelAll?"导出excel（全部数据）":"导出excel（指定数据）"))])],1)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogViewTicket=!1}}},[e._v("关闭")])],1)])],1)}),[],!1,null,null,null);t.default=z.exports},"9cd3":function(e,t,a){e.exports=a("5ab9")},a06f:function(e,t,a){e.exports=a("74e7")},ae85:function(e,t,a){"use strict";var n=a("9f12"),r=a("53fe"),i=a("8b83"),c=a("c65a"),o=a("c03e"),l=a("9ab4"),s=a("60a3"),u=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"handleDel",value:function(e){var t=this;this.$confirm("确定删除该内容？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("del",e)}))}},{key:"handleView",value:function(e){this.$emit("view",e)}},{key:"handleAdd",value:function(){this.$emit("add")}},{key:"handleEdit",value:function(){this.$emit("edit")}}]),t}(s.h);l.a([Object(s.f)("params",{type:Object,default:function(){}})],u.prototype,"props",void 0),l.a([Object(s.e)({type:Boolean,default:!1})],u.prototype,"onlyView",void 0),l.a([Object(s.e)({type:Boolean,default:!1})],u.prototype,"selection",void 0),u=l.a([s.a],u),t.a=u},bb2f:function(e,t,a){var n=a("d039");e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bc59:function(e,t,a){a("3e47"),a("484e");var n=a("764b");e.exports=n.Array.from},d257:function(e,t,a){"use strict";a("a4d3"),a("4de4"),a("7db0"),a("4160"),a("d81d"),a("13d5"),a("4ec9"),a("e439"),a("dbb4"),a("b64b"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("2b3d"),a("1316"),a("a06f"),a("2dc0");var n=a("2fa7");function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e,t,a,i){return e.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{},t.find((function(t){return t[i]===e[a]})))}))}function c(e,t,a,n){return e.filter((function(e){return 0<t.filter((function(t){return t[n]===e[a]})).length}))}a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return l}));var o,l=(o=document.createElement("a"),document.body.appendChild(o),o.style.display="none",function(e,t){var a=new Blob(e,{type:"octet/stream"}),n=window.URL.createObjectURL(a);o.href=n,o.download=t,o.click(),window.URL.revokeObjectURL(n)})},d58f:function(e,t,a){function n(e){return function(t,a,n,l){r(a);var s=i(t),u=c(s),d=o(s.length),f=e?d-1:0,p=e?-1:1;if(n<2)for(;;){if(f in u){l=u[f],f+=p;break}if(f+=p,e?f<0:d<=f)throw TypeError("Reduce of empty array with no initial value")}for(;e?0<=f:f<d;f+=p)f in u&&(l=a(l,u[f],f,s));return l}}var r=a("1c0b"),i=a("7b0b"),c=a("44ad"),o=a("50c4");e.exports={left:n(!1),right:n(!0)}},e519:function(e,t,a){a("a5eb")({target:"Array",stat:!0},{isArray:a("6220")})},f183:function(e,t,a){function n(e){o(e,u,{value:{objectID:"O"+ ++d,weakData:{}}})}var r=a("d012"),i=a("861d"),c=a("5135"),o=a("9bf2").f,l=a("90e3"),s=a("bb2f"),u=l("meta"),d=0,f=Object.isExtensible||function(){return!0},p=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!c(e,u)){if(!f(e))return"F";if(!t)return"E";n(e)}return e[u].objectID},getWeakData:function(e,t){if(!c(e,u)){if(!f(e))return!0;if(!t)return!1;n(e)}return e[u].weakData},onFreeze:function(e){return s&&p.REQUIRED&&f(e)&&!c(e,u)&&n(e),e}};r[u]=!0}}]);