(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c9be1fca"],{4072:function(e,t,a){"use strict";a("7db0"),a("caad"),a("b0c0"),a("b64b"),a("2532");var r=a("9f12"),o=a("53fe"),n=a("8b83"),i=a("c65a"),l=a("c03e"),c=a("9ab4"),s=a("60a3"),u=function(e){function t(){return Object(r.a)(this,t),Object(n.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"handleBack",value:function(){this.$router.back()}},{key:"handleSubmit",value:function(){var e=this,t=this.$children.find((function(e){if(e.$options.name)return e.$options.name.toUpperCase().includes("FORM")}));if(t){var a=t.$children[0];a&&a.validate((function(a,r){var o=Object.keys(r);o.length&&t.$refs[o[0]].$el.scrollIntoView(!0),a&&e.$emit("submit",t[e.formKey])}))}}}]),t}(s.h);c.a([Object(s.e)({type:Object,default:function(){}})],u.prototype,"data",void 0),c.a([Object(s.e)({type:String,default:"form"})],u.prototype,"formKey",void 0),c.a([Object(s.e)({type:Boolean,default:!1})],u.prototype,"loading",void 0),c.a([Object(s.e)({type:Boolean,default:!1})],u.prototype,"disabledButton",void 0);var d=u=c.a([Object(s.a)({name:"LayoutDetail"})],u),f=(a("a028"),a("2877")),m=Object(f.a)(d,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"layout-form"},[a("div",{staticClass:"layout-form__container"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e._t("default")],2),a("div",{staticClass:"global__block--horizontal-center"},[a("el-button",{attrs:{type:"primary",disabled:e.loading,round:"",plain:""},on:{click:e.handleSubmit}},[a("i",{staticClass:"el-icon-thumb"}),e._v(" 保存 ")]),a("el-button",{attrs:{disabled:e.loading,round:""},on:{click:e.handleBack}},[a("i",{staticClass:"el-icon-back"}),e._v(" 返回 ")])],1)])])}),[],!1,null,"6f84e491",null);t.a=m.exports},"64cc":function(e,t,a){},a028:function(e,t,a){"use strict";var r=a("64cc");a.n(r).a},b28c:function(e,t,a){"use strict";a.r(t),a("ac1f"),a("5319"),a("96cf");var r=a("89ba"),o=a("9f12"),n=a("53fe"),i=a("8b83"),l=a("c65a"),c=a("c03e"),s=a("9ab4"),u=a("60a3"),d=(a("a4d3"),a("e01a"),a("4160"),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(i.a)(this,Object(l.a)(t).apply(this,arguments))).dictType=[{label:"兑换卡",value:"EXCHANGE"}],e.form={id:"",coverImage:"",name:"",cardType:"EXCHANGE",amount:1,beginDate:"",endDate:"",description:"",remark:""},e.validateUpload=function(t,a,r){a?(e.form.coverImage&&e.$refs.form.validateField("upload"),r()):r(new Error("请上传卡券封面图"))},e.validateDesc=function(t,a,r){a?(e.form.description&&e.$refs.form.validateField("description"),r()):r(new Error("请输入卡券描述"))},e.rules={amount:[{required:!0,message:"请输入卡券金额",trigger:"blur"}],name:[{required:!0,message:"请输入卡券名称",trigger:"blur"}],remark:[{required:!0,message:"请输入卡券备注",trigger:"blur"}],coverImage:[{required:!0,trigger:"change",validator:e.validateUpload}],beginDate:[{trigger:"change",required:!0,message:"请选择有效日期"}],type:[{required:!0,message:"请选择卡券类型",trigger:"change"}],description:[{required:!0,validator:e.validateDesc,trigger:"blur"}]},e}return Object(c.a)(t,e),Object(n.a)(t,[{key:"watchValue",value:function(e){this.form=Object.assign({},this.form,e)}},{key:"watchForm",value:function(e){var t=this;["description","coverImage"].forEach((function(a){(e[a]||e[a.length])&&t.$refs.form.clearValidate(a)}))}},{key:"dateRange",get:function(){return[this.form.beginDate,this.form.endDate]},set:function(e){this.form.beginDate=e[0],this.form.endDate=e[1]}}]),t}(u.h));s.a([Object(u.e)({type:Object,default:function(){}})],d.prototype,"data",void 0),s.a([Object(u.i)("data",{deep:!0,immediate:!0})],d.prototype,"watchValue",null),s.a([Object(u.i)("form",{deep:!0})],d.prototype,"watchForm",null);var f=d=s.a([Object(u.a)({name:"FormEdit"})],d),m=a("2877"),p=Object(m.a)(f,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{ref:"name",attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"名称不能超过8个字符",maxlength:8},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{ref:"amount",attrs:{label:"金额",prop:"amount"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v("元")])])],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{ref:"cardType",attrs:{label:"类型",prop:"cardType"}},[a("el-radio-group",{model:{value:e.form.cardType,callback:function(t){e.$set(e.form,"cardType",t)},expression:"form.cardType"}},e._l(e.dictType,(function(t,r){return a("el-radio",{key:r,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{ref:"beginDate",attrs:{label:"有效期",prop:"beginDate"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1)],1)],1),a("el-form-item",{ref:"coverImage",attrs:{label:"图片",prop:"coverImage"}},[a("slw-upload",{attrs:{limit:1,autoCropWidth:750,autoCropHeight:450},model:{value:e.form.coverImage,callback:function(t){e.$set(e.form,"coverImage",t)},expression:"form.coverImage"}})],1),a("el-form-item",{ref:"remark",attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{placeholder:"备注不能超过200个字符",type:"textarea",maxlength:200,autosize:{minRows:2,maxRows:4}},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("el-form-item",{ref:"description",attrs:{label:"描述",prop:"description"}},[a("slw-editor",{attrs:{type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)}),[],!1,null,null,null).exports,b=a("4072"),v=a("9ff6"),h=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(i.a)(this,Object(l.a)(t).apply(this,arguments))).detail={},e.loading=!1,e}var a,s;return Object(c.a)(t,e),Object(n.a)(t,[{key:"created",value:(s=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(sessionStorage[v.a]=!1,t=this.$route.params.id)return this.loading=!0,e.next=6,this.$ajax.ajax({method:"GET",url:"v1/cards/subjects/".concat(t)});e.next=8;break;case 6:this.detail=e.sent,this.loading=!1;case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"handleEdit",value:(a=Object(r.a)(regeneratorRuntime.mark((function e(t){var a,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.$route.params.id,this.loading=!0,e.next=4,this.$ajax.ajax({method:a?"PUT":"POST",url:"v1/cards/subjects",data:t});case 4:e.sent&&(this.$notify.success({title:"提示",message:"".concat(a?"编辑":"新增","成功")}),sessionStorage[v.a]=!0,setTimeout((function(){r.$router.replace({path:"/ticket"})}),1e3)),this.loading=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}]),t}(u.h),g=h=s.a([Object(u.a)({name:"TicketEdit",components:{FormEdit:p,LayoutForm:b.a},beforeRouteLeave:function(e,t,a){"false"===sessionStorage[v.a]?this.$confirm("您还未保存页面内容，确定需要提出吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a()})).catch((function(){a(!1)})):a()}})],h),y=Object(m.a)(g,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout-form",{attrs:{loading:e.loading},on:{submit:e.handleEdit}},[a("form-edit",{attrs:{data:e.detail}})],1)}),[],!1,null,null,null);t.default=y.exports},e01a:function(e,t,a){"use strict";var r=a("23e7"),o=a("83ab"),n=a("da84"),i=a("5135"),l=a("861d"),c=a("9bf2").f,s=a("e893"),u=n.Symbol;if(o&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var d={},f=function(e){var t=arguments.length<1||void 0===e?void 0:String(e),a=this instanceof f?new u(t):void 0===t?u():u(t);return""===t&&(d[a]=!0),a};s(f,u);var m=f.prototype=u.prototype;m.constructor=f;var p=m.toString,b="Symbol(test)"==String(u("test")),v=/^Symbol\((.*)\)[^)]+$/;c(m,"description",{configurable:!0,get:function(){var e=l(this)?this.valueOf():this,t=p.call(e);if(i(d,e))return"";var a=b?t.slice(7,-1):t.replace(v,"$1");return""===a?void 0:a}}),r({global:!0,forced:!0},{Symbol:f})}}}]);