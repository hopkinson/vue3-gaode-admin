(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-51a7d0e0"],{"367d":function(e,t,a){"use strict";a.r(t),a("ac1f"),a("5319"),a("96cf");var r=a("89ba"),i=a("9f12"),o=a("53fe"),n=a("8b83"),s=a("c65a"),l=a("c03e"),c=a("9ab4"),u=a("60a3"),p=(a("a4d3"),a("e01a"),a("4de4"),a("4160"),a("caad"),a("d81d"),a("b0c0"),a("2532"),function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(n.a)(this,Object(s.a)(t).apply(this,arguments))).form={id:"",coverImage:"",name:"",price:1,introduction:"",images:[],description:"",supplierName:"",specification:""},e.validateUpload=function(t,a,r){a.length?(e.$refs.form.validateField("upload"),r()):r(new Error("请上传商品图"))},e.validateDesc=function(t,a,r){a?(e.form.description&&e.$refs.form.validateField("description"),r()):r(new Error("请输入商品描述"))},e.rules={price:[{required:!0,message:"请输入商品金额",trigger:"blur"}],specification:[{required:!0,message:"请输入商品规格",trigger:"blur"}],supplierName:[{required:!0,message:"请输入商品供应商",trigger:"blur"}],name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],introduction:[{required:!0,message:"请输入商品介绍",trigger:"blur"}],images:[{required:!0,trigger:"change",validator:e.validateUpload}],description:[{required:!0,validator:e.validateDesc,trigger:"blur"}]},e}return Object(l.a)(t,e),Object(o.a)(t,[{key:"handleFetchQuery",value:function(e,t){t(e?this.queryData.filter((function(t){return t.name.includes(e)})):this.queryData)}},{key:"watchValue",value:function(e){var t=this;e&&this.$nextTick((function(){t.form=Object.assign({},t.form,e)}))}},{key:"watchForm",value:function(e){var t=this;e.images&&(this.form.coverImage=e.images.length?e.images[0].url:""),["description","images"].forEach((function(a){(e[a]||e[a.length])&&t.$refs.form.clearValidate(a)}))}},{key:"uploadImage",get:function(){return this.form.images?this.form.images.map((function(e){return e.url})):[]},set:function(e){this.form.images=e.map((function(e,t){return{url:e,sort:t,remark:""}}))}}]),t}(u.h));c.a([Object(u.e)({type:Object,default:function(){}})],p.prototype,"data",void 0),c.a([Object(u.e)({type:Array,default:function(){return[]}})],p.prototype,"queryData",void 0),c.a([Object(u.i)("data",{deep:!0,immediate:!0})],p.prototype,"watchValue",null),c.a([Object(u.i)("form",{deep:!0})],p.prototype,"watchForm",null);var d=p=c.a([Object(u.a)({name:"FormEdit"})],p),f=a("2877"),m=Object(f.a)(d,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{ref:"name",attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"不能超过20个字符",maxlength:20},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{ref:"specification",attrs:{label:"规格",prop:"specification"}},[a("el-input",{attrs:{placeholder:"不能超过20个字符",maxlength:20},model:{value:e.form.specification,callback:function(t){e.$set(e.form,"specification",t)},expression:"form.specification"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{ref:"supplierName",attrs:{label:"供应商",prop:"supplierName"}},[a("el-autocomplete",{attrs:{maxlength:20,"value-key":"name","fetch-suggestions":e.handleFetchQuery},model:{value:e.form.supplierName,callback:function(t){e.$set(e.form,"supplierName",t)},expression:"form.supplierName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{ref:"price",attrs:{label:"金额",prop:"price"}},[a("el-input",{attrs:{type:"number"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v("元")])])],1)],1)],1),a("el-form-item",{ref:"images",attrs:{label:"图片",prop:"images"}},[a("slw-upload",{attrs:{limit:4,autoCropWidth:750,autoCropHeight:422,"list-type":"picture-card"},model:{value:e.uploadImage,callback:function(t){e.uploadImage=t},expression:"uploadImage"}})],1),a("el-form-item",{ref:"introduction",attrs:{label:"介绍",prop:"introduction"}},[a("el-input",{attrs:{placeholder:"不能超过200个字符",type:"textarea",maxlength:200,autosize:{minRows:2,maxRows:4}},model:{value:e.form.introduction,callback:function(t){e.$set(e.form,"introduction",t)},expression:"form.introduction"}})],1),a("el-form-item",{ref:"description",attrs:{label:"描述",prop:"description"}},[a("slw-editor",{attrs:{type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)}),[],!1,null,null,null).exports,h=a("4072"),b=a("9ff6"),g=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(n.a)(this,Object(s.a)(t).apply(this,arguments))).detail={},e.queryData=[],e.loading=!1,e}var a,c;return Object(l.a)(t,e),Object(o.a)(t,[{key:"created",value:(c=Object(r.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return sessionStorage[b.a]=!1,e.next=3,this.$ajax.ajax({method:"GET",url:"v1/goods/suppliers",query:{pageSize:100}});case 3:if(this.queryData=e.sent,t=this.$route.params.id)return this.loading=!0,e.next=9,this.$ajax.ajax({method:"GET",url:"v1/goods/".concat(t)});e.next=11;break;case 9:this.detail=e.sent,this.loading=!1;case 11:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"handleEdit",value:(a=Object(r.a)(regeneratorRuntime.mark((function e(t){var a,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.$route.params.id,this.loading=!0,e.next=4,this.$ajax.ajax({method:a?"PUT":"POST",url:"v1/goods",data:t});case 4:e.sent&&(this.$notify.success({title:"提示",message:"".concat(a?"编辑":"新增","成功")}),sessionStorage[b.a]=!0,setTimeout((function(){r.$router.replace({path:"/product"})}),1e3)),this.loading=!1;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}]),t}(u.h),v=g=c.a([Object(u.a)({name:"ProductEdit",components:{FormEdit:m,LayoutForm:h.a},beforeRouteLeave:function(e,t,a){"false"===sessionStorage[b.a]?this.$confirm("您还未保存页面内容，确定需要提出吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a()})).catch((function(){a(!1)})):a()}})],g),y=Object(f.a)(v,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout-form",{attrs:{loading:e.loading},on:{submit:e.handleEdit}},[a("form-edit",{attrs:{data:e.detail,"query-data":e.queryData}})],1)}),[],!1,null,null,null);t.default=y.exports},4072:function(e,t,a){"use strict";a("7db0"),a("caad"),a("b0c0"),a("b64b"),a("2532");var r=a("9f12"),i=a("53fe"),o=a("8b83"),n=a("c65a"),s=a("c03e"),l=a("9ab4"),c=a("60a3"),u=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(n.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"handleBack",value:function(){this.$router.back()}},{key:"handleSubmit",value:function(){var e=this,t=this.$children.find((function(e){if(e.$options.name)return e.$options.name.toUpperCase().includes("FORM")}));if(t){var a=t.$children[0];a&&a.validate((function(a,r){var i=Object.keys(r);i.length&&t.$refs[i[0]].$el.scrollIntoView(!0),a&&e.$emit("submit",t[e.formKey])}))}}}]),t}(c.h);l.a([Object(c.e)({type:Object,default:function(){}})],u.prototype,"data",void 0),l.a([Object(c.e)({type:String,default:"form"})],u.prototype,"formKey",void 0),l.a([Object(c.e)({type:Boolean,default:!1})],u.prototype,"loading",void 0),l.a([Object(c.e)({type:Boolean,default:!1})],u.prototype,"disabledButton",void 0);var p=u=l.a([Object(c.a)({name:"LayoutDetail"})],u),d=(a("a028"),a("2877")),f=Object(d.a)(p,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"layout-form"},[a("div",{staticClass:"layout-form__container"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e._t("default")],2),a("div",{staticClass:"global__block--horizontal-center"},[a("el-button",{attrs:{type:"primary",disabled:e.loading,round:"",plain:""},on:{click:e.handleSubmit}},[a("i",{staticClass:"el-icon-thumb"}),e._v(" 保存 ")]),a("el-button",{attrs:{disabled:e.loading,round:""},on:{click:e.handleBack}},[a("i",{staticClass:"el-icon-back"}),e._v(" 返回 ")])],1)])])}),[],!1,null,"6f84e491",null);t.a=f.exports},"64cc":function(e,t,a){},a028:function(e,t,a){"use strict";var r=a("64cc");a.n(r).a},e01a:function(e,t,a){"use strict";var r=a("23e7"),i=a("83ab"),o=a("da84"),n=a("5135"),s=a("861d"),l=a("9bf2").f,c=a("e893"),u=o.Symbol;if(i&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var p={},d=function(e){var t=arguments.length<1||void 0===e?void 0:String(e),a=this instanceof d?new u(t):void 0===t?u():u(t);return""===t&&(p[a]=!0),a};c(d,u);var f=d.prototype=u.prototype;f.constructor=d;var m=f.toString,h="Symbol(test)"==String(u("test")),b=/^Symbol\((.*)\)[^)]+$/;l(f,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=m.call(e);if(n(p,e))return"";var a=h?t.slice(7,-1):t.replace(b,"$1");return""===a?void 0:a}}),r({global:!0,forced:!0},{Symbol:d})}}}]);