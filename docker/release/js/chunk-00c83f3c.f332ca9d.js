(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-00c83f3c"],{"13ca":function(e,t,a){"use strict";a.r(t),a("a4d3"),a("4de4"),a("4160"),a("e439"),a("dbb4"),a("b64b"),a("159b");var r=a("2fa7"),n=(a("96cf"),a("89ba")),l=a("9f12"),s=a("53fe"),i=a("8b83"),o=a("c65a"),c=a("c03e"),u=a("9ab4"),p=a("60a3"),f=a("4f97"),b=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(i.a)(this,Object(o.a)(t).apply(this,arguments))).dictBill=f.a,e.form={name:"",type:"",status:""},e}return Object(c.a)(t,e),Object(s.a)(t,[{key:"handleSearch",value:function(){return this.$emit("search"),Object.assign({},this.value,this.form,{pageNum:1})}}]),t}(p.h);u.a([Object(p.d)("input",{type:Object,default:function(){return{}}})],b.prototype,"value",void 0),u.a([Object(p.b)("input")],b.prototype,"handleSearch",null);var d=b=u.a([Object(p.a)({name:"FormSearch"})],b),m=a("2877"),h=Object(m.a)(d,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{inline:!0,model:e.form,size:"small"}},[a("el-form-item",{attrs:{label:"订单号"}},[a("el-input",{model:{value:e.form.no,callback:function(t){e.$set(e.form,"no",t)},expression:"form.no"}})],1),a("el-form-item",{attrs:{label:"运单号"}},[a("el-input",{model:{value:e.form.trackingNumber,callback:function(t){e.$set(e.form,"trackingNumber",t)},expression:"form.trackingNumber"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.dictBill.status,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")])],1)],1)}),[],!1,null,null,null).exports,v=a("ae85"),y=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(i.a)(this,Object(o.a)(t).apply(this,arguments))).dictBill=f.a,e}return Object(c.a)(t,e),t}(Object(p.c)(v.a)),x=y=u.a([Object(p.a)({inheritAttrs:!1,components:{FormSearch:h},name:"TableList",filters:{trackingNumber:function(e,t){return e?t||"填写":"-"}}})],y),j=Object(m.a)(x,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("slw-table",e._g(e._b({},"slw-table",e.$attrs,!1),e.$listeners),[a("template",{slot:"query"},[e._t("default")],2),a("el-table-column",{attrs:{prop:"no",label:"订单号",width:"180px"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[e._v(" "+e._s(e._f("filterDict")(t.row.status,e.dictBill.status))+" ")])}}])}),a("el-table-column",{attrs:{prop:"name",label:"商品",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.goods,(function(t,r){return a("p",{key:r},[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.$emit("view-product",t)}}},[e._v(e._s(r+1)+". "+e._s(t.name))])],1)}))}}])}),a("el-table-column",{attrs:{label:"数量"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[e._v(" "+e._s(t.row.goods?t.row.goods.length:0)+" ")])}}])}),a("el-table-column",{attrs:{prop:"name",label:"支付方式"}}),a("el-table-column",{attrs:{label:"交易金额"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[e._v(e._s(e._f("formatMoney")(t.row.amount)))])}}])}),a("el-table-column",{attrs:{prop:"paymentUserName",label:"交易用户"}}),a("el-table-column",{attrs:{prop:"receiver",label:"联系人"}}),a("el-table-column",{attrs:{prop:"receiverAddress",label:"收件地址"}}),a("el-table-column",{attrs:{label:"运单号"},scopedSlots:e._u([{key:"default",fn:function(t){return a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.$emit("express",t.row)}}},[e._v(e._s(e._f("trackingNumber")(t.row.status,t.row.trackingNumber)))])}}])}),a("el-table-column",{attrs:{label:"支付时间",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return a("span",{},[e._v(e._s(e._f("formatDay")(t.row.paymentTime,"YYYY-MM-DD HH:mm:ss")))])}}])})],2)}),[],!1,null,null,null).exports,g=(a("caad"),a("b0c0"),a("2532"),function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(i.a)(this,Object(o.a)(t).apply(this,arguments))).form={id:"",expressCompanyCode:"",expressCompanyName:"",trackingNumber:""},e}return Object(c.a)(t,e),Object(s.a)(t,[{key:"handleFetchQuery",value:function(e,t){t(e?this.queryData.filter((function(t){return t.name.includes(e)})):this.queryData)}},{key:"handleSelect",value:function(e){this.form.expressCompanyCode=e.code}}]),t}(p.h));u.a([Object(p.e)({type:Array,default:function(){return[]}})],g.prototype,"queryData",void 0);var O=g=u.a([Object(p.a)({name:"FormSearch"})],g),k=Object(m.a)(O,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{model:e.form,size:"small","label-position":"right","label-width":"90px",inline:""}},[a("el-form-item",{attrs:{label:"物流公司"}},[a("el-autocomplete",{attrs:{maxlength:20,"value-key":"name","fetch-suggestions":e.handleFetchQuery},on:{select:e.handleSelect},model:{value:e.form.expressCompanyName,callback:function(t){e.$set(e.form,"expressCompanyName",t)},expression:"form.expressCompanyName"}})],1),a("el-form-item",{attrs:{label:"运单号"}},[a("el-input",{model:{value:e.form.trackingNumber,callback:function(t){e.$set(e.form,"trackingNumber",t)},expression:"form.trackingNumber"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("submit",e.form)}}},[e._v("保存")])],1)],1)}),[],!1,null,null,null).exports,w=(a("7db0"),a("c740"),a("d81d"),a("26e9"),a("60a6")),_=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(i.a)(this,Object(o.a)(t).apply(this,arguments))).dictBill=f.a,e}return Object(c.a)(t,e),Object(s.a)(t,[{key:"traces",get:function(){var e=this.data.traces;return e?e.reverse():[]}},{key:"traceLength",get:function(){var e=this.data.traces;return e?e.length:0}},{key:"expressStatus",get:function(){var e=f.a.express,t=this.data.state;return e.findIndex((function(e){return e.value===t}))}},{key:"showExpressStep",get:function(){var e=f.a.express.map((function(e){return e.value})),t=this.data.state;return!!t&&e.includes(t)}},{key:"abnormalStatus",get:function(){var e=this.data.state,t=f.a.abnormalStatus.find((function(t){return t.value===e}));return t?t.label:""}}]),t}(p.h);u.a([Object(p.e)({type:Object,default:function(){}})],_.prototype,"data",void 0);var E=_=u.a([Object(p.a)({name:"GridExpress",components:{LayoutDetail:w.a}})],_),S=Object(m.a)(E,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout-detail",{attrs:{"show-footer":!1}},[a("el-form",{attrs:{"label-position":"right"}},[a("el-form-item",{attrs:{label:"状态"}},[e.showExpressStep?a("slw-step",{attrs:{active:e.expressStatus}},e._l(e.dictBill.express,(function(t,r){return a("slw-step-item",{key:r},[e._v(e._s(t.label))])})),1):a("el-alert",{attrs:{type:"warning",closable:!1,title:e.abnormalStatus}})],1),a("el-form-item",{attrs:{label:"物流详情"}},[a("slw-step",{attrs:{direction:"vertical",active:e.traceLength}},e._l(e.traces,(function(t,r){return a("slw-step-item",{key:r},[a("p",[e._v(e._s(t.acceptStation))]),a("p",[e._v(e._s(e._f("formatDay")(t.acceptTime,"YYYY-MM-DD HH:mm:ss")))])])})),1)],1)],1)],1)}),[],!1,null,null,null).exports;function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(a,!0).forEach((function(t){Object(r.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var N=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(i.a)(this,Object(o.a)(t).apply(this,arguments))).params={pageNum:1,pageSize:10},e.dialogExpress=!1,e.loading=!1,e.data={},e.expressList=[],e.bill={id:"",no:"",freight:0,amount:0,receiver:"",receiverMobile:"",receiverAddress:"",status:0,goods:[]},e.expressDetail={},e}var a,r,u,p,f;return Object(c.a)(t,e),Object(s.a)(t,[{key:"hanldeFetchData",value:(f=Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.$ajax.ajax({method:"GET",url:"v1/orders",query:this.params});case 3:this.data=e.sent,this.loading=!1;case 5:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"handleGoDetail",value:function(e){var t=e.goodsId;this.$router.push({path:"/product/detail/".concat(t)})}},{key:"handleDel",value:(p=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax.ajax({method:"DELETE",url:"v1/subjects/".concat(t.id)});case 2:if(e.sent)return e.next=6,this.hanldeFetchData();e.next=8;break;case 6:e.next=9;break;case 8:this.$notify.error({title:"提示",message:"删除失败"});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"handleFillExpress",value:(u=Object(n.a)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.status)return this.bill=t,e.next=4,this.$ajax.ajax({method:"GET",url:"v1/express/".concat(this.bill.id)});e.next=7;break;case 4:a=e.sent,this.expressDetail=a||{},this.dialogExpress=!0;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"handleSaveExpress",value:(r=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$ajax.ajax({method:"PUT",url:"v1/orders/express",data:$({},t,{id:this.bill.id})});case 2:if(e.sent){e.next=9;break}return e.next=6,this.$ajax.ajax({method:"GET",url:"v1/express/".concat(this.bill.id)});case 6:return this.expressDetail=e.sent,e.next=9,this.hanldeFetchData();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"watchDialog",value:(a=Object(n.a)(regeneratorRuntime.mark((function e(t){var a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}if(this.expressList.length){e.next=7;break}return e.next=4,this.$ajax.ajax({method:"GET",url:"v1/express/companies",query:{pageSize:1e3}});case 4:a=e.sent,r=a.records,this.expressList=r;case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}]),t}(p.h);u.a([Object(p.i)("dialogExpress",{deep:!0})],N.prototype,"watchDialog",null);var C=N=u.a([Object(p.a)({name:"TicketIndex",components:{TableList:j,FormSearch:h,GridExpress:S,FormExpress:k}})],N),F=Object(m.a)(C,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"ticket"},[a("table-list",{attrs:{"del-tip":"确定要删除该卡券吗？",data:e.data},on:{fetch:e.hanldeFetchData,"view-product":e.handleGoDetail,express:e.handleFillExpress},model:{value:e.params,callback:function(t){e.params=t},expression:"params"}},[a("form-search",{on:{search:function(t){e.data={}}},model:{value:e.params,callback:function(t){e.params=t},expression:"params"}})],1),a("slw-dialog",{attrs:{title:"物流信息",width:"50%","show-close":""},model:{value:e.dialogExpress,callback:function(t){e.dialogExpress=t},expression:"dialogExpress"}},[a("form-express",{attrs:{"query-data":e.expressList},on:{submit:e.handleSaveExpress}}),Object.keys(e.expressDetail).length?[a("hr"),a("grid-express",{attrs:{data:e.expressDetail}})]:e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"})],2)],1)}),[],!1,null,null,null);t.default=F.exports},"1edd":function(e,t,a){},"26e9":function(e,t,a){"use strict";var r=a("23e7"),n=a("e8b5"),l=[].reverse,s=[1,2];r({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return n(this)&&(this.length=this.length),l.call(this)}})},"4f97":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return n}));var r={type:[{label:"现金卡",value:1},{label:"充值卡",value:2},{label:"兑换卡",value:3}],constType:[{label:"现金卡",value:"CASH"},{label:"充值卡",value:"CHARGE"},{label:"兑换卡",value:"EXCHANGE"}],status:[{label:"未激活",value:0},{label:"已激活",value:1},{label:"已使用",value:2},{label:"已过期",value:99}],useStatus:[{label:"未兑换",value:0},{label:"已兑换",value:1}]},n={status:[{label:"待付款",value:0},{label:"待发货",value:1},{label:"待收货",value:2},{label:"已完成",value:3},{label:"已关闭",value:4}],express:[{label:"已揽收",value:1},{label:"在途中",value:2},{label:"到达派件城市",value:201},{label:"签收",value:3}],abnormalStatus:[{label:"无轨迹",value:0},{label:"问题件",value:4}]}},"60a6":function(e,t,a){"use strict";var r=a("9f12"),n=a("8b83"),l=a("c65a"),s=a("c03e"),i=a("9ab4"),o=a("60a3"),c=function(e){function t(){return Object(r.a)(this,t),Object(n.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(s.a)(t,e),t}(o.h);i.a([Object(o.e)({default:!0})],c.prototype,"showFooter",void 0);var u=c=i.a([Object(o.a)({name:"LayoutDetail"})],c),p=(a("9dc2"),a("2877")),f=Object(p.a)(u,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"layout-detail"},[a("div",{staticClass:"layout-detail__container"},[e._t("default"),e.showFooter?a("el-button",{staticClass:"global__block--horizontal-center",attrs:{round:""},on:{click:function(t){return e.$router.back()}}},[a("i",{staticClass:"el-icon-back"}),e._v(" 返回 ")]):e._e()],2)])}),[],!1,null,null,null);t.a=f.exports},"9dc2":function(e,t,a){"use strict";var r=a("1edd");a.n(r).a},ae85:function(e,t,a){"use strict";var r=a("9f12"),n=a("53fe"),l=a("8b83"),s=a("c65a"),i=a("c03e"),o=a("9ab4"),c=a("60a3"),u=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(n.a)(t,[{key:"handleDel",value:function(e){var t=this;this.$confirm("确定删除该内容？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("del",e)}))}},{key:"handleView",value:function(e){this.$emit("view",e)}},{key:"handleAdd",value:function(){this.$emit("add")}},{key:"handleEdit",value:function(){this.$emit("edit")}}]),t}(c.h);o.a([Object(c.f)("params",{type:Object,default:function(){}})],u.prototype,"props",void 0),o.a([Object(c.e)({type:Boolean,default:!1})],u.prototype,"onlyView",void 0),o.a([Object(c.e)({type:Boolean,default:!1})],u.prototype,"selection",void 0),u=o.a([c.a],u),t.a=u},c740:function(e,t,a){"use strict";var r=a("23e7"),n=a("b727").findIndex,l=a("44d2"),s="findIndex",i=!0;s in[]&&Array(1)[s]((function(){i=!1})),r({target:"Array",proto:!0,forced:i},{findIndex:function(e,t){return n(this,e,1<arguments.length?t:void 0)}}),l(s)}}]);